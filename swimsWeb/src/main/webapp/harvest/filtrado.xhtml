<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">

<h:head>
	<title>Filtrado de registros</title>
	<h:outputStylesheet name="/css/primeflex.min.css" />
</h:head>
<h:body>
	<p:growl>
		<p:autoUpdate />
	</p:growl>
	<div>
		<h:form>
			<p:menubar>
				<p:menuitem icon="pi pi-fw pi-home" value="Inicio"
					action="/index?faces-redirect=true"></p:menuitem>
				<p:menuitem icon="pi pi-fw pi-sign-in" value="Iniciar sesión"
					action="sesion?faces-redirect=true"></p:menuitem>
				<p:submenu label="Parámetros del sistema" icon="pi pi-fw pi-cog">
					<p:menuitem value="Sets OAI"
						action="/sysparams/oai-sets?faces-redirect=true">
					</p:menuitem>
				</p:submenu>
				<f:facet name="options">
					<p:button value="Perfil" icon="pi pi-fw pi-angle-down"
						styleClass="ui-button-info" />
				</f:facet>
			</p:menubar>
		</h:form>

		<div class="p-pt-2">
			<h:form>
				<p:card>
					<f:facet name="title">
			Selección de trabajos de titulación
			</f:facet>
					<p:steps activeIndex="2">
						<p:menuitem value="Origen" />
						<p:menuitem value="Fecha"
							action="#{oaiRecordBean.forwardToDateSelection()}" />
						<p:menuitem value="Filtrado" />
						<p:menuitem value="Confirmación" />
					</p:steps>
					<div class="p-pt-4">
						<div class="ui-fluid">
							<p:dataTable value="#{oaiRecordBean.oaiRecordDtos}"
								var="oaiRecordDto" reflow="true" rows="10" paginator="true">
								<p:column headerText="Titulo">
									<h:outputText rendered="#{oaiRecordDto.titles.size() ge 1}"
										value="#{oaiRecordDto.titles.get(0)}" />
									<h:outputText rendered="#{oaiRecordDto.titles.size() eq 0}"
										value="Registro sin título" />
								</p:column>

								<p:column headerText="Autor">
									<h:outputText rendered="#{oaiRecordDto.creators.size() ge 1}"
										value="#{oaiRecordDto.creators.get(0)}" />
									<h:outputText rendered="#{oaiRecordDto.creators.size() eq 0}"
										value="Registro sin autor" />
								</p:column>

								<p:column headerText="Director">
									<h:outputText
										rendered="#{oaiRecordDto.contributors.size() ge 1}"
										value="#{oaiRecordDto.creators.get(0)}" />
									<h:outputText
										rendered="#{oaiRecordDto.contributors.size() eq 0}"
										value="Registro sin director" />
								</p:column>

								<p:column headerText="Descripción">
									<h:outputText
										rendered="#{oaiRecordDto.descriptions.size() ge 1}"
										value="#{oaiRecordDto.descriptions.get(0)}" />
									<h:outputText
										rendered="#{oaiRecordDto.descriptions.size() eq 0}"
										value="Registro sin descripción" />
								</p:column>

								<p:column headerText="Fecha">
									<h:outputText rendered="#{oaiRecordDto.dates.size() ge 1}"
										value="#{oaiRecordBean.dateFormat.format(oaiRecordDto.dates.get(0))}" />
									<h:outputText rendered="#{oaiRecordDto.dates.size() eq 0}"
										value="Registro sin fecha" />
								</p:column>

								<p:column>
									<p:commandButton icon="pi pi-fw pi-plus"
										oncomplete="PF('allRecordInfoDialog').show()"
										update=":allRecordInfoForm"
										onclick="#{oaiRecordBean.setSelectedOaiRecordDto(oaiRecordDto)}"></p:commandButton>
								</p:column>
							</p:dataTable>
						</div>
					</div>
					<f:facet name="footer">
						<p:commandButton icon="pi pi-fw pi-angle-double-left"
							value="Regresar" styleClass="ui-button-secondary"
							action="/harvest/fecha?faces-redirect=true" />

						<p:commandButton styleClass="p-ml-2"
							icon="pi pi-fw pi-angle-double-right" value="Avanzar" />

					</f:facet>
				</p:card>
			</h:form>
		</div>

		<p:dialog blockScroll="true" header="Toda la información del registro" showEffect="fade"
			modal="true" widgetVar="allRecordInfoDialog" responsive="true">
			<h:form id="allRecordInfoForm">
				<div class="ui-fluid">
					<div class="p-field">
						<p:panel
							rendered="#{oaiRecordBean.selectedOaiRecordDto.titles.size() gt 1}"
							header="Títulos" toggleable="true" collapsed="true">
							<p:dataScroller
								value="#{oaiRecordBean.selectedOaiRecordDto.titles}" var="title">
								<h:outputText value="#{title}" />
							</p:dataScroller>
						</p:panel>
						<p:panel
							rendered="#{oaiRecordBean.selectedOaiRecordDto.titles.size() eq 1}"
							header="Título" toggleable="true" collapsed="false">
							<h:outputText
								value="#{oaiRecordBean.selectedOaiRecordDto.titles.get(0)}" />
						</p:panel>
					</div>

					<div class="p-field">
						<p:panel
							rendered="#{oaiRecordBean.selectedOaiRecordDto.creators.size() gt 1}"
							header="Autores" toggleable="true" collapsed="true">
							<p:dataScroller
								value="#{oaiRecordBean.selectedOaiRecordDto.creators}"
								var="iterable">
								<h:outputText value="#{iterable}" />
							</p:dataScroller>
						</p:panel>
						<p:panel
							rendered="#{oaiRecordBean.selectedOaiRecordDto.creators.size() eq 1}"
							header="Autor" toggleable="true" collapsed="false">
							<h:outputText
								value="#{oaiRecordBean.selectedOaiRecordDto.creators.get(0)}" />
						</p:panel>
					</div>

					<div class="p-field">
						<p:panel
							rendered="#{oaiRecordBean.selectedOaiRecordDto.creators.size() gt 1}"
							header="Autores" toggleable="true" collapsed="true">
							<p:dataScroller
								value="#{oaiRecordBean.selectedOaiRecordDto.creators}"
								var="iterable">
								<h:outputText value="#{iterable}" />
							</p:dataScroller>
						</p:panel>
						<p:panel
							rendered="#{oaiRecordBean.selectedOaiRecordDto.creators.size() eq 1}"
							header="Autor" toggleable="true" collapsed="false">
							<h:outputText
								value="#{oaiRecordBean.selectedOaiRecordDto.creators.get(0)}" />
						</p:panel>
					</div>

					<div class="p-field">
						<p:panel
							rendered="#{oaiRecordBean.selectedOaiRecordDto.subjects.size() gt 1}"
							header="Palabras clave" toggleable="true" collapsed="true">
							<p:dataScroller
								value="#{oaiRecordBean.selectedOaiRecordDto.subjects}"
								var="iterable">
								<h:outputText value="#{iterable}" />
							</p:dataScroller>
						</p:panel>
						<p:panel
							rendered="#{oaiRecordBean.selectedOaiRecordDto.subjects.size() eq 1}"
							header="Palabra clave" toggleable="true" collapsed="false">
							<h:outputText
								value="#{oaiRecordBean.selectedOaiRecordDto.subjects.get(0)}" />
						</p:panel>
					</div>

				</div>
			</h:form>
		</p:dialog>


	</div>
</h:body>
</html>